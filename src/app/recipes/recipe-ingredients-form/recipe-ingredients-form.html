    <div class="form-section">
      <div class="section-header">
        <h3>Ingredients</h3>
        <button mat-icon-button type="button" (click)="addIngredient()">
          <mat-icon class="green">add</mat-icon>
        </button>
      </div>
      <div>
        <div *ngFor="let ingredient of ingredients.controls; let i = index" [formGroup]="getAsFormGroup(ingredient)" class="ingredient-row">
          <mat-form-field appearance="fill" class="ingredient-field">
            <mat-label>Ingredient</mat-label>
            <input
              matInput
              formControlName="ingredientName"
              placeholder="Search ingredient..."
              [matAutocomplete]="autoIngredient">
            <mat-autocomplete #autoIngredient="matAutocomplete" (optionSelected)="onIngredientSelected(i, $event)">
              <mat-option *ngFor="let suggestion of ingredientSuggestions[i] | async" [value]="suggestion">
                {{ suggestion.name }}
              </mat-option>
            </mat-autocomplete>
            <mat-error *ngIf="getAsFormGroup(ingredient).get('ingredientId')?.hasError('required')">
              Ingredient is required
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="fill" class="amount-field">
            <mat-label>Amount</mat-label>
            <input matInput type="number" formControlName="amount" min="0" step="0.1">
            <mat-error *ngIf="getAsFormGroup(ingredient).get('amount')?.hasError('required')">
              Required
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="fill" class="unit-field">
            <mat-label>Unit</mat-label>
            <mat-select formControlName="unit">
              <mat-option *ngFor="let unit of availableUnits" [value]="unit.value">
                {{ unit.label }}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="getAsFormGroup(ingredient).get('unit')?.hasError('required')">
              Required
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="fill" class="description-field">
            <mat-label>Description (Optional)</mat-label>
            <input matInput formControlName="description" placeholder="e.g., chopped">
          </mat-form-field>

          <button mat-icon-button type="button" (click)="removeIngredient(i)">
            <mat-icon class="green">delete</mat-icon>
          </button>
        </div>
      </div>
    </div>
